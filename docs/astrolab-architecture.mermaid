graph TB
    subgraph "ğŸŒŸ AstroLab Core Architecture"
        
        subgraph "ğŸ“Š Data Layer"
            subgraph "Data Sources"
                GAIA[("ğŸ”­ Gaia DR3")]
                SDSS[("ğŸŒŒ SDSS")]
                NSA[("ğŸŒ  NSA")]
                TNG50[("ğŸŒ€ TNG50")]
                EXOPLANET[("ğŸª Exoplanet")]
                LINEAR[("â˜„ï¸ LINEAR")]
                RRLYRAE[("â­ RR Lyrae")]
                TWOMASS[("ğŸŒŸ 2MASS")]
                WISE[("ğŸ”¥ WISE")]
                DES[("ğŸ“· DES")]
            end
            
            subgraph "Data Processing"
                COLLECTORS["ğŸ“¥ Collectors<br/>â€¢ Survey Downloaders<br/>â€¢ Data Fetchers"]
                PREPROCESSORS["ğŸ”§ Preprocessors<br/>â€¢ Data Cleaning<br/>â€¢ Format Conversion<br/>â€¢ Feature Extraction"]
                TRANSFORMS["ğŸ”„ Transforms<br/>â€¢ Coordinate Conversions<br/>â€¢ Normalization<br/>â€¢ Augmentation"]
                SAMPLERS["ğŸ² Samplers<br/>â€¢ Stratified Sampling<br/>â€¢ Balanced Sampling"]
            end
            
            subgraph "Data Organization"
                DATASET["ğŸ“ Dataset<br/>â€¢ PyG Data Objects<br/>â€¢ TensorDict Integration<br/>â€¢ Multi-Survey Support"]
                INFO["â„¹ï¸ Info<br/>â€¢ Survey Metadata<br/>â€¢ Column Mappings<br/>â€¢ Statistics"]
                ANALYSIS["ğŸ“ˆ Analysis<br/>â€¢ EDA Tools<br/>â€¢ Statistical Analysis<br/>â€¢ Visualization"]
            end
        end
        
        subgraph "ğŸ§® Tensor Layer"
            TENSORBASE["ğŸ¯ AstroTensorDict<br/>Base Class"]
            SPATIAL["ğŸ“ SpatialTensorDict<br/>â€¢ Coordinates<br/>â€¢ Cosmic Web<br/>â€¢ Clustering"]
            PHOTOMETRIC["ğŸŒˆ PhotometricTensorDict<br/>â€¢ Magnitudes<br/>â€¢ Colors<br/>â€¢ Flux"]
            LIGHTCURVE["ğŸ“‰ LightcurveTensorDict<br/>â€¢ Time Series<br/>â€¢ Variability<br/>â€¢ Periodicity"]
            SPECTRAL["ğŸ“Š SpectralTensorDict<br/>â€¢ Wavelength<br/>â€¢ Line Detection"]
            TEMPORAL["â° TemporalTensorDict<br/>â€¢ Evolution<br/>â€¢ Time Steps"]
            COSMOLOGY["ğŸŒŒ CosmologyTensorDict<br/>â€¢ Redshift<br/>â€¢ Distances"]
            IMAGE["ğŸ–¼ï¸ ImageTensorDict<br/>â€¢ 2D/3D Arrays<br/>â€¢ Cutouts"]
        end
        
        subgraph "ğŸ§  Model Layer"
            BASEMODEL["ğŸ—ï¸ BaseModel<br/>â€¢ Abstract Base<br/>â€¢ Common Interface"]
            ASTROMODEL["ğŸŒŸ AstroModel<br/>â€¢ Domain-Specific<br/>â€¢ Survey Integration"]
            
            subgraph "Components"
                ENCODERS["ğŸ”¢ Encoders<br/>â€¢ Position Encoding<br/>â€¢ Feature Encoding"]
                LAYERS["ğŸ“š Layers<br/>â€¢ GNN Layers<br/>â€¢ Attention<br/>â€¢ Custom Ops"]
                AUTOENCODERS["ğŸ”„ Autoencoders<br/>â€¢ VAE<br/>â€¢ Reconstruction"]
            end
            
            MIXINS["ğŸ§© Mixins<br/>â€¢ Explainability<br/>â€¢ Visualization<br/>â€¢ Metrics"]
            UTILS["ğŸ› ï¸ Utils<br/>â€¢ Model Helpers<br/>â€¢ Initialization"]
        end
        
        subgraph "ğŸ‹ï¸ Training Layer"
            LIGHTNING["âš¡ Lightning Module<br/>â€¢ Training Logic<br/>â€¢ Validation<br/>â€¢ Testing"]
            CALLBACKS["ğŸ“ Callbacks<br/>â€¢ Checkpointing<br/>â€¢ Early Stopping<br/>â€¢ Monitoring"]
            TRAINER["ğŸ¯ Trainer<br/>â€¢ Multi-GPU<br/>â€¢ Mixed Precision<br/>â€¢ Profiling"]
            HPO["ğŸ” HPO<br/>â€¢ Optuna Integration<br/>â€¢ Grid Search<br/>â€¢ Bayesian Opt"]
        end
        
        subgraph "ğŸ–¥ï¸ UI Layer"
            MARIMO["ğŸ““ Marimo App<br/>â€¢ Interactive Notebooks<br/>â€¢ Reactive UI"]
            
            subgraph "UI Modules"
                COSMIC_WEB_UI["ğŸ•¸ï¸ Cosmic Web<br/>â€¢ 3D Visualization<br/>â€¢ Clustering Analysis"]
                ANALYSIS_UI["ğŸ“Š Analysis<br/>â€¢ Data Exploration<br/>â€¢ Statistics"]
                TRAINING_UI["ğŸƒ Training<br/>â€¢ Live Monitoring<br/>â€¢ Metrics"]
                VIZ_UI["ğŸ¨ Visualization<br/>â€¢ Plots<br/>â€¢ Interactive Graphics"]
            end
        end
        
        subgraph "ğŸ¨ Widget Layer"
            COSMOGRAPH["ğŸŒ Cosmograph<br/>â€¢ 3D Graph Viz<br/>â€¢ Physics Sim"]
            PLOTLY_BRIDGE["ğŸ“ˆ Plotly Bridge<br/>â€¢ Interactive Plots<br/>â€¢ 3D Scatter"]
            TENSOR_BRIDGE["ğŸŒ‰ Tensor Bridge<br/>â€¢ Data Conversion<br/>â€¢ Format Adapters"]
            GRAPH_WIDGETS["ğŸ“Š Graph Widgets<br/>â€¢ Network Analysis<br/>â€¢ Topology"]
            
            subgraph "Albpy Integration"
                ALBPY_CORE["ğŸ”® Albpy Core<br/>â€¢ Blender Integration<br/>â€¢ 3D Rendering"]
                ALBPY_ADV["ğŸš€ Advanced<br/>â€¢ Animation<br/>â€¢ Complex Scenes"]
            end
        end
        
        subgraph "âš™ï¸ Infrastructure"
            CONFIG["ğŸ“‹ Config<br/>â€¢ Survey Configs<br/>â€¢ Model Configs<br/>â€¢ Training Configs"]
            MEMORY["ğŸ’¾ Memory<br/>â€¢ Caching<br/>â€¢ Memory Maps<br/>â€¢ Optimization"]
            CLI["ğŸ–¥ï¸ CLI<br/>â€¢ Commands<br/>â€¢ Processing<br/>â€¢ Training"]
            MLFLOW["ğŸ“Š MLflow<br/>â€¢ Experiment Tracking<br/>â€¢ Model Registry"]
        end
    end
    
    %% Data Flow Connections
    GAIA --> COLLECTORS
    SDSS --> COLLECTORS
    NSA --> COLLECTORS
    TNG50 --> COLLECTORS
    EXOPLANET --> COLLECTORS
    LINEAR --> COLLECTORS
    RRLYRAE --> COLLECTORS
    TWOMASS --> COLLECTORS
    WISE --> COLLECTORS
    DES --> COLLECTORS
    
    COLLECTORS --> PREPROCESSORS
    PREPROCESSORS --> TRANSFORMS
    TRANSFORMS --> DATASET
    SAMPLERS --> DATASET
    DATASET --> INFO
    DATASET --> ANALYSIS
    
    %% Tensor Connections
    DATASET --> TENSORBASE
    TENSORBASE --> SPATIAL
    TENSORBASE --> PHOTOMETRIC
    TENSORBASE --> LIGHTCURVE
    TENSORBASE --> SPECTRAL
    TENSORBASE --> TEMPORAL
    TENSORBASE --> COSMOLOGY
    TENSORBASE --> IMAGE
    
    %% Model Connections
    SPATIAL --> ASTROMODEL
    PHOTOMETRIC --> ASTROMODEL
    LIGHTCURVE --> ASTROMODEL
    BASEMODEL --> ASTROMODEL
    ENCODERS --> ASTROMODEL
    LAYERS --> ASTROMODEL
    AUTOENCODERS --> ASTROMODEL
    MIXINS --> ASTROMODEL
    
    %% Training Connections
    ASTROMODEL --> LIGHTNING
    LIGHTNING --> TRAINER
    CALLBACKS --> TRAINER
    HPO --> TRAINER
    TRAINER --> MLFLOW
    
    %% UI Connections
    TRAINER --> TRAINING_UI
    DATASET --> ANALYSIS_UI
    SPATIAL --> COSMIC_WEB_UI
    ANALYSIS --> VIZ_UI
    COSMIC_WEB_UI --> MARIMO
    ANALYSIS_UI --> MARIMO
    TRAINING_UI --> MARIMO
    VIZ_UI --> MARIMO
    
    %% Widget Connections
    SPATIAL --> COSMOGRAPH
    SPATIAL --> PLOTLY_BRIDGE
    TENSORBASE --> TENSOR_BRIDGE
    SPATIAL --> GRAPH_WIDGETS
    COSMOGRAPH --> ALBPY_CORE
    ALBPY_CORE --> ALBPY_ADV
    
    %% Infrastructure Connections
    CONFIG --> DATASET
    CONFIG --> ASTROMODEL
    CONFIG --> TRAINER
    MEMORY --> DATASET
    CLI --> PREPROCESSORS
    CLI --> TRAINER
    CLI --> COSMIC_WEB_UI
    
    %% Styling
    classDef dataSource fill:#4a5568,stroke:#2d3748,stroke-width:2px,color:#fff
    classDef processing fill:#2b6cb0,stroke:#2c5aa0,stroke-width:2px,color:#fff
    classDef tensor fill:#7c3aed,stroke:#6d28d9,stroke-width:2px,color:#fff
    classDef model fill:#dc2626,stroke:#b91c1c,stroke-width:2px,color:#fff
    classDef training fill:#059669,stroke:#047857,stroke-width:2px,color:#fff
    classDef ui fill:#f59e0b,stroke:#d97706,stroke-width:2px,color:#fff
    classDef widget fill:#ec4899,stroke:#db2777,stroke-width:2px,color:#fff
    classDef infra fill:#6b7280,stroke:#4b5563,stroke-width:2px,color:#fff
    
    class GAIA,SDSS,NSA,TNG50,EXOPLANET,LINEAR,RRLYRAE,TWOMASS,WISE,DES dataSource
    class COLLECTORS,PREPROCESSORS,TRANSFORMS,SAMPLERS,DATASET,INFO,ANALYSIS processing
    class TENSORBASE,SPATIAL,PHOTOMETRIC,LIGHTCURVE,SPECTRAL,TEMPORAL,COSMOLOGY,IMAGE tensor
    class BASEMODEL,ASTROMODEL,ENCODERS,LAYERS,AUTOENCODERS,MIXINS,UTILS model
    class LIGHTNING,CALLBACKS,TRAINER,HPO training
    class MARIMO,COSMIC_WEB_UI,ANALYSIS_UI,TRAINING_UI,VIZ_UI ui
    class COSMOGRAPH,PLOTLY_BRIDGE,TENSOR_BRIDGE,GRAPH_WIDGETS,ALBPY_CORE,ALBPY_ADV widget
    class CONFIG,MEMORY,CLI,MLFLOW infra