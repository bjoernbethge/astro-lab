# md17

Part of `torch_geometric.datasets`
Module: `torch_geometric.datasets.md17`

## Functions (3)

### `download_url(url: str, folder: str, log: bool = True, filename: Optional[str] = None)`

Downloads the content of an URL to a specific folder.

Args:
    url (str): The URL.
    folder (str): The folder.
    log (bool, optional): If :obj:`False`, will not print anything to the
        console. (default: :obj:`True`)
    filename (str, optional): The filename of the downloaded file. If set
        to :obj:`None`, will correspond to the filename given by the URL.
        (default: :obj:`None`)

### `extract_tar(path: str, folder: str, mode: str = 'r:gz', log: bool = True) -> None`

Extracts a tar archive to a specific folder.

Args:
    path (str): The path to the tar archive.
    folder (str): The folder.
    mode (str, optional): The compression mode. (default: :obj:`"r:gz"`)
    log (bool, optional): If :obj:`False`, will not print anything to the
        console. (default: :obj:`True`)

### `extract_zip(path: str, folder: str, log: bool = True) -> None`

Extracts a zip archive to a specific folder.

Args:
    path (str): The path to the tar archive.
    folder (str): The folder.
    log (bool, optional): If :obj:`False`, will not print anything to the
        console. (default: :obj:`True`)

## Classes (3)

### `Data`

A data object describing a homogeneous graph.
The data object can hold node-level, link-level and graph-level attributes.
In general, :class:`~torch_geometric.data.Data` tries to mimic the
behavior of a regular :python:`Python` dictionary.
In addition, it provides useful functionality for analyzing graph
structures, and provides basic PyTorch tensor functionalities.
See `here <https://pytorch-geometric.readthedocs.io/en/latest/get_started/
introduction.html#data-handling-of-graphs>`__ for the accompanying
tutorial.

.. code-block:: python

    from torch_geometric.data import Data

    data = Data(x=x, edge_index=edge_index, ...)

    # Add additional arguments to `data`:
    data.train_idx = torch.tensor([...], dtype=torch.long)
    data.test_mask = torch.tensor([...], dtype=torch.bool)

    # Analyzing the graph structure:
    data.num_nodes
    >>> 23

    data.is_directed()
    >>> False

    # PyTorch tensor functionality:
    data = data.pin_memory()
    data = data.to('cuda:0', non_blocking=True)

Args:
    x (torch.Tensor, optional): Node feature matrix with shape
        :obj:`[num_nodes, num_node_features]`. (default: :obj:`None`)
    edge_index (LongTensor, optional): Graph connectivity in COO format
        with shape :obj:`[2, num_edges]`. (default: :obj:`None`)
    edge_attr (torch.Tensor, optional): Edge feature matrix with shape
        :obj:`[num_edges, num_edge_features]`. (default: :obj:`None`)
    y (torch.Tensor, optional): Graph-level or node-level ground-truth
        labels with arbitrary shape. (default: :obj:`None`)
    pos (torch.Tensor, optional): Node position matrix with shape
        :obj:`[num_nodes, num_dimensions]`. (default: :obj:`None`)
    time (torch.Tensor, optional): The timestamps for each event with shape
        :obj:`[num_edges]` or :obj:`[num_nodes]`. (default: :obj:`None`)
    **kwargs (optional): Additional attributes.

#### Methods

- **`stores_as(self, data: Self)`**

- **`to_dict(self) -> Dict[str, Any]`**
  Returns a dictionary of stored key/value pairs.

- **`to_namedtuple(self) -> <function NamedTuple at 0x000001FE17E66F20>`**
  Returns a :obj:`NamedTuple` of stored key/value pairs.

### `InMemoryDataset`

Dataset base class for creating graph datasets which easily fit
into CPU memory.
See `here <https://pytorch-geometric.readthedocs.io/en/latest/tutorial/
create_dataset.html#creating-in-memory-datasets>`__ for the accompanying
tutorial.

Args:
    root (str, optional): Root directory where the dataset should be saved.
        (optional: :obj:`None`)
    transform (callable, optional): A function/transform that takes in a
        :class:`~torch_geometric.data.Data` or
        :class:`~torch_geometric.data.HeteroData` object and returns a
        transformed version.
        The data object will be transformed before every access.
        (default: :obj:`None`)
    pre_transform (callable, optional): A function/transform that takes in
        a :class:`~torch_geometric.data.Data` or
        :class:`~torch_geometric.data.HeteroData` object and returns a
        transformed version.
        The data object will be transformed before being saved to disk.
        (default: :obj:`None`)
    pre_filter (callable, optional): A function that takes in a
        :class:`~torch_geometric.data.Data` or
        :class:`~torch_geometric.data.HeteroData` object and returns a
        boolean value, indicating whether the data object should be
        included in the final dataset. (default: :obj:`None`)
    log (bool, optional): Whether to print any console output while
        downloading and processing the dataset. (default: :obj:`True`)
    force_reload (bool, optional): Whether to re-process the dataset.
        (default: :obj:`False`)

#### Methods

- **`len(self) -> int`**
  Returns the number of data objects stored in the dataset.

- **`get(self, idx: int) -> torch_geometric.data.data.BaseData`**
  Gets the data object at index :obj:`idx`.

- **`load(self, path: str, data_cls: Type[torch_geometric.data.data.BaseData] = <class 'torch_geometric.data.data.Data'>) -> None`**
  Loads the dataset from the file path :obj:`path`.

### `MD17`

A variety of ab-initio molecular dynamics trajectories from the authors
of `sGDML <http://quantum-machine.org/gdml>`_.
This class provides access to the original MD17 datasets, their revised
versions, and the CCSD(T) trajectories.

For every trajectory, the dataset contains the Cartesian positions of atoms
(in Angstrom), their atomic numbers, as well as the total energy
(in kcal/mol) and forces (kcal/mol/Angstrom) on each atom.
The latter two are the regression targets for this collection.

.. note::

    Data objects contain no edge indices as these are most commonly
    constructed via the :obj:`torch_geometric.transforms.RadiusGraph`
    transform, with its cut-off being a hyperparameter.

The `original MD17 dataset <https://arxiv.org/abs/1611.04678>`_ contains
ten molecule trajectories.
This version of the dataset was found to suffer from high numerical noise.
The `revised MD17 dataset <https://arxiv.org/abs/2007.09593>`_ contains the
same molecules, but the energies and forces were recalculated at the
PBE/def2-SVP level of theory using very tight SCF convergence and very
dense DFT integration grid.
The third version of the dataset contains fewer molecules, computed at the
CCSD(T) level of theory.
The benzene molecule at the DFT FHI-aims level of theory was
`released separately <https://arxiv.org/abs/1802.09238>`_.

Check the table below for detailed information on the molecule, level of
theory and number of data points contained in each dataset.
Which trajectory is loaded is determined by the :attr:`name` argument.
For the coupled cluster trajectories, the dataset comes with pre-defined
training and testing splits which are loaded separately via the
:attr:`train` argument.

+--------------------+--------------------+-------------------------------+-----------+
| Molecule           | Level of Theory    | Name                          | #Examples |
+====================+====================+===============================+===========+
| Benzene            | DFT                | :obj:`benzene`                | 627,983   |
+--------------------+--------------------+-------------------------------+-----------+
| Uracil             | DFT                | :obj:`uracil`                 | 133,770   |
+--------------------+--------------------+-------------------------------+-----------+
| Naphthalene        | DFT                | :obj:`napthalene`             | 326,250   |
+--------------------+--------------------+-------------------------------+-----------+
| Aspirin            | DFT                | :obj:`aspirin`                | 211,762   |
+--------------------+--------------------+-------------------------------+-----------+
| Salicylic acid     | DFT                | :obj:`salicylic acid`         | 320,231   |
+--------------------+--------------------+-------------------------------+-----------+
| Malonaldehyde      | DFT                | :obj:`malonaldehyde`          | 993,237   |
+--------------------+--------------------+-------------------------------+-----------+
| Ethanol            | DFT                | :obj:`ethanol`                | 555,092   |
+--------------------+--------------------+-------------------------------+-----------+
| Toluene            | DFT                | :obj:`toluene`                | 442,790   |
+--------------------+--------------------+-------------------------------+-----------+
| Paracetamol        | DFT                | :obj:`paracetamol`            | 106,490   |
+--------------------+--------------------+-------------------------------+-----------+
| Azobenzene         | DFT                | :obj:`azobenzene`             | 99,999    |
+--------------------+--------------------+-------------------------------+-----------+
| Benzene (R)        | DFT (PBE/def2-SVP) | :obj:`revised benzene`        | 100,000   |
+--------------------+--------------------+-------------------------------+-----------+
| Uracil (R)         | DFT (PBE/def2-SVP) | :obj:`revised uracil`         | 100,000   |
+--------------------+--------------------+-------------------------------+-----------+
| Naphthalene (R)    | DFT (PBE/def2-SVP) | :obj:`revised napthalene`     | 100,000   |
+--------------------+--------------------+-------------------------------+-----------+
| Aspirin (R)        | DFT (PBE/def2-SVP) | :obj:`revised aspirin`        | 100,000   |
+--------------------+--------------------+-------------------------------+-----------+
| Salicylic acid (R) | DFT (PBE/def2-SVP) | :obj:`revised salicylic acid` | 100,000   |
+--------------------+--------------------+-------------------------------+-----------+
| Malonaldehyde (R)  | DFT (PBE/def2-SVP) | :obj:`revised malonaldehyde`  | 100,000   |
+--------------------+--------------------+-------------------------------+-----------+
| Ethanol (R)        | DFT (PBE/def2-SVP) | :obj:`revised ethanol`        | 100,000   |
+--------------------+--------------------+-------------------------------+-----------+
| Toluene (R)        | DFT (PBE/def2-SVP) | :obj:`revised toluene`        | 100,000   |
+--------------------+--------------------+-------------------------------+-----------+
| Paracetamol (R)    | DFT (PBE/def2-SVP) | :obj:`revised paracetamol`    | 100,000   |
+--------------------+--------------------+-------------------------------+-----------+
| Azobenzene (R)     | DFT (PBE/def2-SVP) | :obj:`revised azobenzene`     | 99,988    |
+--------------------+--------------------+-------------------------------+-----------+
| Benzene            | CCSD(T)            | :obj:`benzene CCSD(T)`        | 1,500     |
+--------------------+--------------------+-------------------------------+-----------+
| Aspirin            | CCSD               | :obj:`aspirin CCSD`           | 1,500     |
+--------------------+--------------------+-------------------------------+-----------+
| Malonaldehyde      | CCSD(T)            | :obj:`malonaldehyde CCSD(T)`  | 1,500     |
+--------------------+--------------------+-------------------------------+-----------+
| Ethanol            | CCSD(T)            | :obj:`ethanol CCSD(T)`        | 2,000     |
+--------------------+--------------------+-------------------------------+-----------+
| Toluene            | CCSD(T)            | :obj:`toluene CCSD(T)`        | 1,501     |
+--------------------+--------------------+-------------------------------+-----------+
| Benzene            | DFT FHI-aims       | :obj:`benzene FHI-aims`       | 49,863    |
+--------------------+--------------------+-------------------------------+-----------+

.. warning::

    It is advised to not train a model on more than 1,000 samples from the
    original or revised MD17 dataset.

Args:
    root (str): Root directory where the dataset should be saved.
    name (str): Keyword of the trajectory that should be loaded.
    train (bool, optional): Determines whether the train or test split
        gets loaded for the coupled cluster trajectories.
        (default: :obj:`None`)
    transform (callable, optional): A function/transform that takes in an
        :obj:`torch_geometric.data.Data` object and returns a transformed
        version. The data object will be transformed before every access.
        (default: :obj:`None`)
    pre_transform (callable, optional): A function/transform that takes in
        an :obj:`torch_geometric.data.Data` object and returns a
        transformed version. The data object will be transformed before
        being saved to disk. (default: :obj:`None`)
    pre_filter (callable, optional): A function that takes in an
        :obj:`torch_geometric.data.Data` object and returns a boolean
        value, indicating whether the data object should be included in the
        final dataset. (default: :obj:`None`)
    force_reload (bool, optional): Whether to re-process the dataset.
        (default: :obj:`False`)

**STATS:**

.. list-table::
    :widths: 20 10 10 10 10 10
    :header-rows: 1

    * - Name
      - #graphs
      - #nodes
      - #edges
      - #features
      - #tasks
    * - Benzene
      - 627,983
      - 12
      - 0
      - 1
      - 2
    * - Uracil
      - 133,770
      - 12
      - 0
      - 1
      - 2
    * - Naphthalene
      - 326,250
      - 10
      - 0
      - 1
      - 2
    * - Aspirin
      - 211,762
      - 21
      - 0
      - 1
      - 2
    * - Salicylic acid
      - 320,231
      - 16
      - 0
      - 1
      - 2
    * - Malonaldehyde
      - 993,237
      - 9
      - 0
      - 1
      - 2
    * - Ethanol
      - 555,092
      - 9
      - 0
      - 1
      - 2
    * - Toluene
      - 442,790
      - 15
      - 0
      - 1
      - 2
    * - Paracetamol
      - 106,490
      - 20
      - 0
      - 1
      - 2
    * - Azobenzene
      - 99,999
      - 24
      - 0
      - 1
      - 2
    * - Benzene (R)
      - 100,000
      - 12
      - 0
      - 1
      - 2
    * - Uracil (R)
      - 100,000
      - 12
      - 0
      - 1
      - 2
    * - Naphthalene (R)
      - 100,000
      - 10
      - 0
      - 1
      - 2
    * - Aspirin (R)
      - 100,000
      - 21
      - 0
      - 1
      - 2
    * - Salicylic acid (R)
      - 100,000
      - 16
      - 0
      - 1
      - 2
    * - Malonaldehyde (R)
      - 100,000
      - 9
      - 0
      - 1
      - 2
    * - Ethanol (R)
      - 100,000
      - 9
      - 0
      - 1
      - 2
    * - Toluene (R)
      - 100,000
      - 15
      - 0
      - 1
      - 2
    * - Paracetamol (R)
      - 100,000
      - 20
      - 0
      - 1
      - 2
    * - Azobenzene (R)
      - 99,988
      - 24
      - 0
      - 1
      - 2
    * - Benzene CCSD-T
      - 1,500
      - 12
      - 0
      - 1
      - 2
    * - Aspirin CCSD-T
      - 1,500
      - 21
      - 0
      - 1
      - 2
    * - Malonaldehyde CCSD-T
      - 1,500
      - 9
      - 0
      - 1
      - 2
    * - Ethanol CCSD-T
      - 2000
      - 9
      - 0
      - 1
      - 2
    * - Toluene CCSD-T
      - 1,501
      - 15
      - 0
      - 1
      - 2
    * - Benzene FHI-aims
      - 49,863
      - 12
      - 0
      - 1
      - 2

#### Methods

- **`mean(self) -> float`**

- **`download(self) -> None`**
  Downloads the dataset to the :obj:`self.raw_dir` folder.

- **`process(self) -> None`**
  Processes the dataset to the :obj:`self.processed_dir` folder.
